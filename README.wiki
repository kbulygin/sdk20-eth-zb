Источник: http://embedded.ifmo.ru/wiki/index.php5/SDK-2.0_Ethernet-ZigBee

'''SDK-2.0 Ethernet-ZigBee''' — программное обеспечение, позволяющее с персонального компьютера получить доступ к [[ZigBee]]-устройствам через ЛВС [[Ethernet]] с помощью стенда [[SDK-2.0]], подключенного к той же ЛВС.

== Постановка задачи ==
Задачи управления и мониторинга устройств беспроводной сенсорной сети ZigBee требуют доступа к этой сети.
Обеспечение операторов индивидуальными ZigBee-модулями, подключаемыми к ПК, для этой цели является не лучшим решением, поскольку они будут использоваться неэффективно, если доступ к сети нужен не очень часто. Кроме этого, такой подход достаточно затратен и сомнителен с точки зрения безопасности.
А вот доступ к сети Ethernet на операторских рабочих станциях, как правило, уже имеется. Следовательно, в той же ЛВС, в которой находятся рабочие станции операторов, можно создать единый сервер, обеспечивающий им всем доступ к сенсорной сети. Такой сервер, помимо наличия интерфейсов Ethernet и ZigBee, должен обладать достаточной для своих задач производительностью и, по возможности, низким энергопотреблением. В учебных целях на роль такого сервера подходит стенд SDK-2.0.

== Выполнение работы ==

Работа по созданию ПО, обеспечивающего работу сервера, потребовала изучения:
* архитектуры стенда SDK-2.0 и отдельных его устройств, в первую очередь, микроконтроллерного ядра и контроллеров интерфейсов Ethernet и ZigBee;
* драйверов используемых интерфейсов (были использованы драйвера из демонстрационного примера [http://embedded.ifmo.ru/sdk/sdk20/soft/examples/keil/hw_tests_sdk_2_0_v1.2.zip]);
* инструментальной цепочки программирования стенда;
* требуемых сетевых технологий и средства отладки их применения;
* способов создания кросс-платформенного Ethernet-клиента для ПК.

Работа велась в ОС GNU/Linux, поэтому использовались соответствующие программные средства:
* кросс-компилятор [[GNUARM|GNU ARM]] 3.4.3 и другие средства, см. [[SDK-2.0]];
* анализатор трафика [http://www.wireshark.org Wireshark];
* генератор пакетов [http://packeth.sourceforge.net PackETH];
* JDK.

В результате было сделано следующее:
* разработана программа для SDK-2.0 на языке Си, способная выполнять функции как Ethernet/ZigBee-сервера, так и ZigBee-клиента;
* разработан Ethernet-клиент для ПК на языке Java;
* адаптированы под конкретное приложение и компиляцию посредством GNU ARM драйвера периферийных устройств из демонстрационного примера.

== Модель работы ==
Пользователь за персональным компьютером запускает клиентскую программу, которой указывает IP-адрес сервера. Потом указывается адрес ZigBee-устройства в сенсорной сети, с которым необходимо связаться, и начинается сеанс обмена текстовыми сообщениями с выбранным ZigBee-устройством.
Для того, чтобы можно было обращаться к серверу по его IP-адресу, в сервере реализована простейшая система ответа на [http://ru.wikipedia.org/wiki/ARP ARP-запросы], посылаемые компьютером, на котором запущена клиентская программа.
Обмен сообщениями между клиентом и сервером реализован по протоколу UDP. Клиент отправляет пакет, в котором в качестве порта-источника указывается порт, на который ожидается получение ответа, а в качестве порта-приёмника указывается адрес ZigBee-клиента (устройства). Пользовательское сообщение (UDP payload) полностью передаётся ZigBee-клиенту, следовательно, сервер может не знать протокол обмена между Ethernet-клиентом и ZigBee-клиентом. Ограничена лишь длина пользовательского сообщения (102 байта — максимальная длина пользовательского сообщения ZigBee-пакета, см. [http://standards.ieee.org/getieee802/download/802.15.4-2006.pdf стандарт IEEE 802.15.4-2006]). Ответ ZigBee-клиента отправляется Ethernet-клиенту в аналогичном UDP-пакете.

== Время ответа ==
Время ответа удалённого ZigBee-клиента на запрос составляет около 300 мс (без вывода отладочной информации на консоль, при прямом соединении ПК и серверного стенда SDK-2.0 по Ethernet, время вычисления ответа незначительно). Цикл обращения к серверу без обмена информацией по ZigBee занимает около 0,3 мс.

== Исходные коды ==
Исходные коды программ доступны [https://github.com/kbulygin/sdk20-eth-zb в репозитории].

Поскольку в ходе работы с драйверами были решены некоторые общие проблемы (использование функции printf при работе через последовательный канал, отправление Ethernet-кадров с малой и нечётной [sic] длиной и др.), были добавлены новые функций, в некоторых местах упрощена реализация старых и т.п., можно использовать данный проект в качестве основы собственных разработок для SDK-2.0. С этой же целью вместе с исходными кодами размещена вся собранная нами документация, касающаяся SDK-2.0.

== Авторы ==
Булыгин Кирилл (kirill.bulygin@قmail.com), Пинкевич Василий (группа 4105, январь 2012 г.)

[[Категория:Студенческие проекты]]
